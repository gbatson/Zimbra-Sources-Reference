# HG changeset patch
# User Dan Villiom Podlaski Christiansen <dan@cabo.dk>
# Date 1400079536 -7200
#      Wed May 14 16:58:56 2014 +0200
# Node ID be5cd76cbd58eb5a93f09569695a4c07b5b7d914
# Parent  4cf89fbc0254f3ef1a4880a15aea4763b83f8242
allow undoing table addition

diff --git a/js/tinymce/plugins/table/classes/Plugin.js b/js/tinymce/plugins/table/classes/Plugin.js
--- a/js/tinymce/plugins/table/classes/Plugin.js
+++ b/js/tinymce/plugins/table/classes/Plugin.js
@@ -660,7 +660,11 @@ define("tinymce/tableplugin/Plugin", [
 								e.stopPropagation();
 								this.parent().cancel();
 
-								insertTable(this.lastX + 1, this.lastY + 1);
+								editor.undoManager.transact((function() {
+									insertTable(this.lastX + 1, this.lastY + 1);
+								}).bind(this));
+
+								editor.addVisual();
 							}
 						}
 					}
